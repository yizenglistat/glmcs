<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Construct Confidence Sets from Posterior Model Probabilities — confidence_set • glmcs</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Construct Confidence Sets from Posterior Model Probabilities — confidence_set"><meta property="og:description" content="For each latent effect (column) in a posterior model probability matrix pmp,
select the smallest set of variables whose cumulative probability reaches at least
coverage.  Optionally filter out sets whose minimum absolute pairwise
correlation (from Rmat) is below cor_threshold, and remove duplicates."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glmcs</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/yizenglistat/glmcs/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Construct Confidence Sets from Posterior Model Probabilities</h1>
    <small class="dont-index">Source: <a href="https://github.com/yizenglistat/glmcs/blob/main/R/utils.R" class="external-link"><code>R/utils.R</code></a></small>
    <div class="hidden name"><code>confidence_set.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>For each latent effect (column) in a posterior model probability matrix <code>pmp</code>,
select the smallest set of variables whose cumulative probability reaches at least
<code>coverage</code>.  Optionally filter out sets whose minimum absolute pairwise
correlation (from <code>Rmat</code>) is below <code>cor_threshold</code>, and remove duplicates.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">confidence_set</span><span class="op">(</span><span class="va">pmp</span>, <span class="va">kept</span>, coverage <span class="op">=</span> <span class="fl">0.95</span>, Rmat <span class="op">=</span> <span class="cn">NULL</span>, cor_threshold <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-pmp">pmp<a class="anchor" aria-label="anchor" href="#arg-pmp"></a></dt>
<dd><p>Numeric matrix of dimension \(p \times L\), where each column sums to 1
and contains posterior inclusion probabilities for each variable and effect.</p></dd>


<dt id="arg-kept">kept<a class="anchor" aria-label="anchor" href="#arg-kept"></a></dt>
<dd><p>Logical vector of length \(L\), indicating which effects (columns) to process.</p></dd>


<dt id="arg-coverage">coverage<a class="anchor" aria-label="anchor" href="#arg-coverage"></a></dt>
<dd><p>Numeric scalar in [0,1], the target cumulative probability for a confidence set.
Defaults to 0.95.</p></dd>


<dt id="arg-rmat">Rmat<a class="anchor" aria-label="anchor" href="#arg-rmat"></a></dt>
<dd><p>Optional \(p \times p\) numeric correlation matrix for the predictors.
If supplied, any set whose minimum off-diagonal absolute correlation is below
<code>cor_threshold</code> is discarded.  Defaults to <code>NULL</code>.</p></dd>


<dt id="arg-cor-threshold">cor_threshold<a class="anchor" aria-label="anchor" href="#arg-cor-threshold"></a></dt>
<dd><p>Numeric scalar in [0,1], the minimum absolute correlation allowed
within a set to pass the correlation filter.  Defaults to 0.5.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A list with components:</p><dl><dt><code>sets</code></dt>
<dd><p>A named list of integer vectors.  Each element <code>cs1</code>, <code>cs2</code>, …
is a confidence set of variable indices that achieves the target coverage.  If no sets
survive the filters, <code>sets</code> is <code>NULL</code>.</p></dd>

<dt><code>claimed</code></dt>
<dd><p>Numeric vector of the actual cumulative probabilities
("claimed coverage") for each returned set.</p></dd>


</dl></div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Simple two-effect example</span></span></span>
<span class="r-in"><span><span class="va">pmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                <span class="fl">0.2</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>              nrow <span class="op">=</span> <span class="fl">3</span>, byrow <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">kept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cs</span> <span class="op">&lt;-</span> <span class="fu">confidence_set</span><span class="op">(</span><span class="va">pmp</span>, <span class="va">kept</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With a correlation filter</span></span></span>
<span class="r-in"><span><span class="va">Rmat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cs2</span> <span class="op">&lt;-</span> <span class="fu">confidence_set</span><span class="op">(</span><span class="va">pmp</span>, <span class="va">kept</span>, coverage <span class="op">=</span> <span class="fl">0.8</span>, Rmat <span class="op">=</span> <span class="va">Rmat</span>, cor_threshold <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Yizeng Li, Wei Pan.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

      </footer></div>






  </body></html>

