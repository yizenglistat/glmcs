# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' @title Univariate Cox Partial Log-Likelihood
#' @description
#'   Computes the partial log‐likelihood for a univariate Cox proportional hazards model,
#'   allowing either the Breslow or Efron approximation to handle tied event times.
#'
#' @param x Numeric vector of covariate values (length n).
#' @param y Numeric matrix with two columns:  
#'   * column 1 = event or censoring times  
#'   * column 2 = status (1 = event, 0 = censored)
#'   Must have n rows.
#' @param offset Numeric vector or scalar; fixed component of the linear predictor.
#'   If scalar, it is recycled to length n.
#' @param theta Numeric scalar coefficient for x (default = 0).
#' @param ties Character; method for tied times.  
#'   * `"breslow"`: Breslow approximation  
#'   * `"efron"` (default): Efron approximation
#'
#' @return A single numeric value: the partial log‐likelihood \eqn{\ell(\theta)}.
#'
#' @examples
#' \dontrun{
#' n <- 100
#' x <- rnorm(n)
#' time <- rexp(n, rate = exp(0.3 * x))
#' status <- rbinom(n, 1, 0.7)
#' y <- cbind(time, status)
#'
#' # compute log‐likelihood at theta = 0.5
#' univariate_loglik_cox(x, y, offset = 0, theta = 0.5, ties = "efron")
#' }
#' @seealso \code{\link{univariate_irls_cox}}
#' @export
univariate_loglik_cox <- function(x, y, offset, theta = 0.0, ties = "efron") {
    .Call('_glmcs_univariate_loglik_cox', PACKAGE = 'glmcs', x, y, offset, theta, ties)
}

#' @title Fit Univariate Cox via Newton–Raphson (IRLS)
#' @description
#'   Finds the MLE of the coefficient in a univariate Cox model by iteratively
#'   maximizing the partial likelihood using Newton–Raphson.
#'
#' @param x Numeric vector of covariate values (length n).
#' @param y Numeric matrix with two columns: event time and status.
#' @param offset Numeric vector or scalar offset term; recycled if scalar.
#' @param ties Character; how to handle ties, `"breslow"` or `"efron"` (default).
#' @param max_iter Integer; maximum number of NR iterations (default = 25).
#' @param tol Numeric; convergence tolerance on theta (default = 1e-8).
#'
#' @return A single numeric value: the estimated coefficient \eqn{\hat\theta}.
#'
#' @examples
#' \dontrun{
#' n <- 100
#' x <- rnorm(n)
#' y <- cbind(rexp(n, rate=exp(0.5*x)), rbinom(n,1,0.8))
#' theta_hat <- univariate_irls_cox(x, y, offset = 0, ties = "efron")
#' }
#' @seealso \code{\link{univariate_loglik_cox}}
#' @export
univariate_irls_cox <- function(x, y, offset, ties = "efron", max_iter = 25L, tol = 1e-8) {
    .Call('_glmcs_univariate_irls_cox', PACKAGE = 'glmcs', x, y, offset, ties, max_iter, tol)
}

