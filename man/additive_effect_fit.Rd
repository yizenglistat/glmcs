% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Rinternal.R
\name{additive_effect_fit}
\alias{additive_effect_fit}
\title{Fit Likelihood-based Additive Single-Effect Regression (LASER) Model}
\arguments{
\item{X}{Numeric matrix (n × p) of predictors.}

\item{y}{Response:
\itemize{
\item For GLMs: numeric vector of length n.
\item For Cox: numeric matrix with 2 columns (time, status) and n rows.
}}

\item{L}{Integer; number of single effects to include (will be set to \code{min(10, L)}).}

\item{family}{A stats::family object (e.g. \code{gaussian()}, \code{binomial()},
\code{poisson()}) or a Cox family list with \code{family = "cox"}.}

\item{standardize}{Logical: if TRUE, center and scale each predictor column before fitting (default: TRUE).}

\item{ties}{Character: ties method for Cox partial likelihood ("efron" or "breslow", default: "efron").}

\item{lambda}{Numeric penalty weight; if ≤ 0, defaults to \eqn{\sqrt{2\log(n)/n}} (default: 0.0).}

\item{tau}{Numeric truncation parameter; if ≤ 0, defaults to 0.5 (default: 0.5).}

\item{null_threshold}{Numeric threshold below which an estimated coefficient is set to zero (default: 1e-6).}

\item{tol}{Numeric; convergence tolerance on the change in expected log-likelihood (default: 5e-2).}

\item{eps}{Numeric; precision (default: 1e-5)}

\item{max_iter}{Integer; maximum number of coordinate-ascent iterations (default: 100).}
}
\value{
A list with components:
\item{niter}{Number of iterations performed.}
\item{loglik}{p × L matrix of univariate log-likelihoods.}
\item{expect_loglik}{Vector of length \code{niter} giving the expected log-likelihood at each iteration.}
\item{final_loglik}{Expected log-likelihood at convergence.}
\item{intercept}{Estimated intercept term.}
\item{dispersion}{Estimated dispersion parameter (for Gaussian/Gamma).}
\item{theta}{p × L matrix of fitted single-effect coefficients.}
\item{pmp}{p × L matrix of posterior model probabilities.}
\item{bic}{p × L matrix of BIC values.}
\item{bic_diff}{p × L matrix of BIC differences from null.}
\item{bf}{p × L matrix of Bayes factors.}
\item{expect_variance}{Length-L vector of PMP-weighted variances.}
\item{kept}{Logical vector of length L; \code{TRUE} for effects retained.}
\item{elapsed_time}{Numeric; total computation time in seconds.}
}
\description{
Fits the LASER model, representing the coefficient vector as a sum of \code{L}
sparse "single effects."  At each iteration, it cyclically applies
\code{\link{single_effect_fit}} to update one effect while holding the others
fixed, then updates the intercept (and dispersion, if applicable), until
convergence or \code{max_iter} is reached.
}
\examples{
\dontrun{
# Gaussian example with 5 effects
X <- matrix(rnorm(100*20), 100, 20)
y <- rnorm(100)
res <- additive_effect_fit(X, y, L = 5, family = gaussian())

# Cox regression example
times  <- rexp(100)
status <- rbinom(100, 1, 0.5)
y_cox  <- cbind(times, status)
res_cox <- additive_effect_fit(X, y_cox, L = 3,
                               family = list(family = "cox"),
                               ties = "breslow")
}
}
