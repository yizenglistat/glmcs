% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core.R
\name{additive_effect_fit}
\alias{additive_effect_fit}
\title{Fit Likelihood-based Additive Single-Effect Regression (LASER) Model}
\usage{
additive_effect_fit(
  X,
  y,
  L,
  family = gaussian(),
  standardize = TRUE,
  null_threshold = 1e-06,
  tol = 0.05,
  ties = "efron",
  max_iter = 100
)
}
\arguments{
\item{X}{Numeric matrix (n × p) of predictors.}

\item{y}{Response:
\itemize{
\item Numeric vector of length \code{n} for GLMs.
\item Numeric matrix (n × 2) with \code{(time,status)} columns for Cox.
}}

\item{L}{Integer; number of single effects to include (will be set to \code{min(10, L)}).}

\item{family}{GLM family object (e.g. \code{gaussian()}, \code{binomial()}, \code{poisson()})
or list with \code{family="cox"} for Cox models.}

\item{standardize}{Logical; if \code{TRUE}, center and scale each column of \code{X}
before fitting (default: \code{TRUE}).}

\item{null_threshold}{Numeric; any posterior probability or coefficient below this
value is set to zero (default: \code{1e-6}).}

\item{tol}{Numeric; convergence tolerance on the change in expected log-likelihood
(default: \code{5e-2}).}

\item{ties}{Character; tie-handling method for Cox IRLS (\code{"efron"} or \code{"breslow"}),
ignored for GLMs (default: \code{"efron"}).}

\item{max_iter}{Integer; maximum number of coordinate-ascent iterations (default: \code{100}).}
}
\value{
A list with components:
\describe{
\item{\code{niter}}{Number of iterations performed.}
\item{\code{loglik}}{p × L matrix of univariate log-likelihoods.}
\item{\code{expect_loglik}}{Vector of length \code{niter} giving the expected
log-likelihood at each iteration.}
\item{\code{final_loglik}}{Expected log-likelihood at convergence.}
\item{\code{intercept}}{Estimated intercept term.}
\item{\code{dispersion}}{Estimated dispersion parameter (for Gaussian/Gamma).}
\item{\code{theta}}{p × L matrix of fitted single-effect coefficients.}
\item{\code{pmp}}{p × L matrix of posterior model probabilities.}
\item{\code{bic}}{p × L matrix of BIC values.}
\item{\code{bic_diff}}{p × L matrix of BIC differences from null.}
\item{\code{bf}}{p × L matrix of Bayes factors.}
\item{\code{expect_variance}}{Length-L vector of PMP-weighted variances.}
\item{\code{kept}}{Logical vector of length L; \code{TRUE} for effects retained.}
\item{\code{elapsed_time}}{Numeric; total computation time in seconds.}
}
}
\description{
Fits the LASER model, representing the coefficient vector as a sum of \code{L}
sparse "single effects."  At each iteration, it cyclically applies
\code{\link{single_effect_fit}} to update one effect while holding the others
fixed, then updates the intercept (and dispersion, if applicable), until
convergence or \code{max_iter} is reached.
}
\examples{
\dontrun{
# Gaussian example with 5 effects
X <- matrix(rnorm(100*20), 100, 20)
y <- rnorm(100)
res <- additive_effect_fit(X, y, L = 5, family = gaussian())

# Cox regression example
times  <- rexp(100)
status <- rbinom(100, 1, 0.5)
y_cox  <- cbind(times, status)
res_cox <- additive_effect_fit(X, y_cox, L = 3,
                               family = list(family = "cox"),
                               ties = "breslow")
}

}
