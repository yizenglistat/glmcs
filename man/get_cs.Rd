% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/internal.R
\name{get_cs}
\alias{get_cs}
\title{Compute Confidence Sets for LASER Model Parameters}
\arguments{
\item{posterior_mat}{NumericMatrix (p Ã— L), posterior inclusion probabilities for each variable
and latent dimension, where:
p = number of variables
L = number of latent dimensions}

\item{keep}{LogicalVector of length L indicating which latent dimensions to include.}

\item{coverage}{Numeric scalar. Target coverage probability for confidence sets (default: 0.95).}

\item{X}{NumericMatrix. Original predictor matrix for computing correlations.
Not required if R is provided.}

\item{R}{NumericMatrix. Pre-computed correlation matrix.
Not required if X is provided.}

\item{check_symmetric}{Logical. If TRUE, forces the correlation matrix to be symmetric
(default: TRUE).}

\item{min_abs_corr}{Numeric scalar. Minimum absolute correlation threshold for filtering
confidence sets (default: 0.5).}

\item{n_purity}{Integer. Maximum number of observations to use for correlation computation
(default: 100).}

\item{squared}{Logical. If TRUE, uses squared correlations (default: FALSE).}
}
\value{
A List containing:
\itemize{
\item sets: List of confidence sets (each as an IntegerVector of variable indices)
\item coverage: NumericVector of claimed coverage for each set
}
If no sets meet the filtering criteria, returns NULL for both elements.
}
\description{
Constructs confidence sets for parameters in a LASER model based on posterior probabilities
and optionally filters them based on correlation purity metrics.
}
\details{
This function constructs confidence sets for each selected latent dimension based on
posterior inclusion probabilities. It then:
\enumerate{
\item Identifies unique sets to avoid duplication
\item Computes the claimed coverage for each set
\item If correlation data is provided, computes purity metrics for each set
\item Filters sets that don't meet minimum correlation thresholds
\item Returns the filtered sets ordered by purity
}

Purity measures assess the independence of variables within each confidence set.
Higher purity indicates stronger independent signals rather than correlated variables.
}
\examples{
\dontrun{
# With posterior matrix and raw data
posterior <- matrix(runif(1000 * 3), 1000, 3)
keep <- c(TRUE, TRUE, FALSE)
X <- matrix(rnorm(100 * 1000), 100, 1000)
result <- get_cs(posterior, keep, coverage = 0.9, X = X, min_abs_corr = 0.3)

# With posterior matrix and correlation matrix
Xcorr <- cor(X)
result <- get_cs(posterior, keep, R = Xcorr, squared = TRUE)
}

}
\seealso{
\code{\link{get_purity}}
}
