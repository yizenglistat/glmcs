% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Rinternal.R
\name{update_dispersion}
\alias{update_dispersion}
\title{Estimate Dispersion for GLM Family}
\arguments{
\item{y}{Numeric response vector of length \code{n}.}

\item{family}{A GLM family object (e.g., \code{gaussian()}, \code{poisson()}, \code{Gamma()}).}

\item{offset}{Numeric vector or scalar representing the linear predictor \code{eta}; defaults to 0.}

\item{approach}{Character string: either \code{"pearson"} or \code{"deviance"}.}
}
\value{
A numeric scalar representing the estimated dispersion.
}
\description{
Computes the dispersion parameter for a Generalized Linear Model (GLM) using either the Pearson residual method or deviance-based approach.
}
\details{
This function supports any \code{family} object from \code{stats::family()}, such as \code{gaussian()}, \code{poisson()}, \code{Gamma()}, etc.
The linear predictor is given by \code{offset}, and the inverse link function is applied to compute the mean response \code{mu}.

If \code{approach = "pearson"}, it computes:
\deqn{ \phi = \frac{1}{n - p} \sum_i \left( \frac{y_i - \mu_i}{\sqrt{\text{var}(\mu_i)}} \right)^2 }

If \code{approach = "deviance"}, it computes:
\deqn{ \phi = \frac{1}{n - p} \sum_i \text{dev}_i }

where \code{dev_i} are the deviance residuals.
}
\examples{
\dontrun{
y <- rgamma(100, shape = 2, rate = 2)
offset <- rep(log(mean(y)), 100)
update_dispersion(y, Gamma(), offset = offset, approach = "pearson")
}

}
