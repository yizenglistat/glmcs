% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/method.R
\name{iskept}
\alias{iskept}
\title{Select Columns with Concentrated Probability Mass or Maximum Non-Uniformity}
\usage{
iskept(X, eps = 1e-09)
}
\arguments{
\item{X}{A numeric matrix with dimensions \code{p Ã— L}, where:
\itemize{
\item Each column represents a probability vector
\item Each column should sum to 1 (or approximately 1 due to floating-point precision)
\item Columns with negative values or sums significantly different from 1 may produce unexpected results
}}

\item{eps}{Level of precision}
}
\value{
A logical vector of length \code{L} where:
\itemize{
\item \code{TRUE} indicates a column is selected ("kept")
\item \code{FALSE} indicates a column is not selected
\item Column names from \code{X} are preserved in the result
\item At least one element will always be \code{TRUE}
}
}
\description{
Identifies columns in a probability matrix that have their mass concentrated in
few entries (reaching a cumulative threshold quickly when sorted). If no columns
meet this concentration criterion, selects the single column that deviates most
from uniformity.
}
\details{
This function implements a two-step column selection process:

\bold{Step 1: Concentration-based selection}
For each column in matrix \code{X}:
\itemize{
\item Values are sorted in descending order
\item The cumulative sum is computed
\item If the cumulative sum exceeds threshold \code{thr} before using all entries,
the column is considered "concentrated" and marked \code{TRUE}
\item This identifies columns where a small subset of entries contain most of the probability mass
}

\bold{Step 2: Uniformity-based fallback}
If no column meets the concentration criterion:
\itemize{
\item Computes the squared Euclidean distance from each column to the uniform vector \code{(1/p, ..., 1/p)}
\item Selects only the column with the maximum distance from uniformity
\item This guarantees at least one column is always selected
}
}
\note{
\itemize{
\item The function works best when input columns are valid probability vectors (non-negative, sum to 1)
\item For edge cases where multiple columns tie for maximum distance from uniformity, only one is selected
\item Computational complexity scales linearly with the number of columns
}
}
