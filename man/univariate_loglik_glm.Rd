% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/Rinternal.R
\name{univariate_loglik_glm}
\alias{univariate_loglik_glm}
\title{Compute Log-Likelihood for Univariate GLM}
\arguments{
\item{x}{Numeric vector of length \code{n}: the single covariate.}

\item{y}{Numeric vector of length \code{n}: response values (for
Binomial, can be 0/1 or a two-column matrix of counts).}

\item{family}{An R \code{family} object (from \code{stats::family()},
default \code{gaussian()}).}

\item{theta}{Numeric scalar: coefficient at which to evaluate the
log-likelihood.}

\item{offset}{Numeric vector of length \code{n}, or scalar, default 0:
optional offset in the linear predictor.}

\item{intercept}{Numeric scalar: intercept term in the linear predictor, default 0.}
}
\value{
Numeric scalar: the (profiled) log-likelihood at \code{theta} and \code{intercept}.
}
\description{
Computes the log-likelihood for a univariate generalized linear model (GLM)
with a single covariate, intercept, and optional offset. Supports any family from
\code{stats::family()} (e.g.\ Gaussian, Binomial, Poisson).
}
\details{
The function forms the linear predictor
\code{η = intercept + offset + θ * x}, then uses the family's
\code{linkinv} and \code{dev.resids} functions to compute deviance
residuals \code{d_i}.  The log-likelihood is
\deqn{\ell = -\,\sum_i d_i / 2,} profiling out dispersion for families
that estimate it (Gaussian, Gamma, inverse.gaussian) and leaving it fixed
for others (Binomial, Poisson).
}
\examples{
\dontrun{
x <- rnorm(100)
y <- 1.5 + 2 * x + rnorm(100)
univariate_loglik_glm(x, y, family = gaussian(), theta = 2, intercept = 1.5)

x <- runif(200, -2, 2)
p <- plogis(0.5 + 1.5 * x)
y_bin <- rbinom(200, 1, p)
univariate_loglik_glm(x, y_bin, family = binomial(), theta = 1.5, intercept = 0.5)

x_p <- rpois(150, lambda = 2)
mu <- exp(-1 + 0.3 * x_p)
y_p <- rpois(150, mu)
univariate_loglik_glm(x_p, y_p, family = poisson(), theta = 0.3, intercept = -1)
}
}
