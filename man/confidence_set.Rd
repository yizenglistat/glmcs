% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/utils.R
\name{confidence_set}
\alias{confidence_set}
\title{Construct Confidence Sets from Posterior Model Probabilities}
\usage{
confidence_set(pmp, kept, coverage = 0.95, Rmat = NULL, cor_threshold = 0.5)
}
\arguments{
\item{pmp}{Numeric matrix of dimension \eqn{p \times L}, where each column sums to 1
and contains posterior inclusion probabilities for each variable and effect.}

\item{kept}{Logical vector of length \eqn{L}, indicating which effects (columns) to process.}

\item{coverage}{Numeric scalar in [0,1], the target cumulative probability for a confidence set.
Defaults to 0.95.}

\item{Rmat}{Optional \eqn{p \times p} numeric correlation matrix for the predictors.
If supplied, any set whose minimum off-diagonal absolute correlation is below
\code{cor_threshold} is discarded.  Defaults to \code{NULL}.}

\item{cor_threshold}{Numeric scalar in [0,1], the minimum absolute correlation allowed
within a set to pass the correlation filter.  Defaults to 0.5.}
}
\value{
A list with components:
\describe{
\item{\code{sets}}{A named list of integer vectors.  Each element \code{cs1}, \code{cs2}, â€¦
is a confidence set of variable indices that achieves the target coverage.  If no sets
survive the filters, \code{sets} is \code{NULL}.}
\item{\code{claimed}}{Numeric vector of the actual cumulative probabilities
("claimed coverage") for each returned set.}
}
}
\description{
For each latent effect (column) in a posterior model probability matrix \code{pmp},
select the smallest set of variables whose cumulative probability reaches at least
\code{coverage}.  Optionally filter out sets whose minimum absolute pairwise
correlation (from \code{Rmat}) is below \code{cor_threshold}, and remove duplicates.
}
\examples{
# Simple two-effect example
pmp <- matrix(c(0.6, 0.3, 0.1,
                0.2, 0.5, 0.3),
              nrow = 3, byrow = FALSE)
kept <- c(TRUE, TRUE)
cs <- confidence_set(pmp, kept)

# With a correlation filter
Rmat <- cor(matrix(rnorm(9), nrow = 3))
cs2 <- confidence_set(pmp, kept, coverage = 0.8, Rmat = Rmat, cor_threshold = 0.2)

}
